# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞ –≤ **—Ç—Ä—ë—Ö workspace**: *dev*, *staging* –∏ *prod*.

> –ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º CUDA-–±—ç–∫–µ–Ω–¥–æ–º PyTorch (—Å–º. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](03_environment_setup.md)):
> ```bash
> uv python pin 3.12
> uv sync --extra cu124   # –∏–ª–∏ cu128
> ```

## 1. Git submodules

–í—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–∞–∫ **git submodule**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–≤–∏–∑–∏–∏;
- –æ–±–Ω–æ–≤–ª—è—Ç—å –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π `git submodule update --remote`;
- –∏–º–µ—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
git submodule update --init --recursive          # git clone + –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

git submodule update --remote --merge            # –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–∞–∫–µ—Ç—ã

# –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç
git submodule add https://github.com/ORG/new_pkg.git packages/new_pkg

# —É–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç
git submodule deinit -f packages/old_pkg && git rm -f packages/old_pkg
```

> –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ submodule –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
> ```bash
> git submodule update --init
> ```
> —á—Ç–æ–±—ã –ø–æ–¥—Ç—è–Ω—É—Ç—å –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ö–µ—à –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

## 2. dev-—Å–±–æ—Ä–∫–∞ (packages/* –≤ —Ä–µ–∂–∏–º–µ workspace)

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–∫–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `packages/<pkg>` (–¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ submodule) –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç `pyproject.toml`.
1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –∫–æ—Ä–Ω–µ–≤–æ–º `pyproject.toml` –ø–∞–∫–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω –≤ `[tool.uv.sources]`:
   ```toml
   [tool.uv.sources]
   hello-world = { workspace = true }
   ```
1. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç –≤ `[project].dependencies` —Ç–∞–º, –≥–¥–µ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
1. –û–±–Ω–æ–≤–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ dev:
   ```bash
   uv sync --extra cu124 --all-packages   # –∏–ª–∏ cu128
   ```

## 3. staging-—Å–±–æ—Ä–∫–∞ (—Ñ–∏–∫—Å–∞—Ü–∏—è dev-—Ç–µ–≥–æ–≤)

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –ø–∞–∫–µ—Ç –ø–æ–ª—É—á–∏–ª dev-—Ç–µ–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä `v0.1.0.dev0`):

1. –û—Ç–∫—Ä–æ–π—Ç–µ `staging/pyproject.toml` –∏ –¥–æ–±–∞–≤—å—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫ Git:
   ```toml
   [tool.uv.sources]
   hello-world = { git = "https://github.com/USER/hello_world", tag = "v0.1.0.dev0", subdirectory = "." }
   ```
2. –ü–µ—Ä–µ—Å—á–∏—Ç–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ staging:
   ```bash
   uv lock --project staging
   uv sync --project staging --frozen --extra cu124   # –∏–ª–∏ cu128
   ```

## 4. prod-—Å–±–æ—Ä–∫–∞ (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑)

–í `prod/pyproject.toml` —É–∫–∞–∂–∏—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π Git-—Ç–µ–≥:

```toml
[tool.uv.sources]
hello-world = { git = "https://github.com/USER/hello_world", tag = "v0.1.0", subdirectory = "." }
```

–î–∞–ª–µ–µ:
```bash
uv lock --project prod
uv sync --project prod --frozen --extra cu124   # –∏–ª–∏ cu128
```

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π
- **[Docker –∏ –¥–µ–ø–ª–æ–π](07_docker_deployment.md)** ‚Äî —Å–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
- **[–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è](08_tooling_automation.md)** ‚Äî release_tool, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–ª–∏–∑–æ–≤

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞
- **[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏](04_dependency_management.md)** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –ø–∞–∫–µ—Ç—ã
- **[Dev/Staging/Prod —Ä–µ–∂–∏–º—ã](02_dev_staging_prod.md)** ‚Äî –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏
