# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Python-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ –∏ PyTorch-–±—ç–∫–µ–Ω–¥–æ–≤ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞.

## 1. –§–∏–∫—Å–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ Python (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω `>=3.10, !=3.11.*, <3.13`, –Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ **–≤—Å–µ–≥–¥–∞** —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

```bash
uv python pin 3.12   # —Å–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç .python-version
```

–§–∞–π–ª `.python-version` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ —á–∏—Ç–∞–µ—Ç—Å—è `uv`, `pyenv`, `asdf` –∏ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.

### –°–º–µ–Ω–∞ –≤–µ—Ä—Å–∏–∏ Python

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º pin
uv python pin 3.10

# –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º lock –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ
uv lock --extra cu124
uv sync --extra cu124
```

## 2. –í—ã–±–æ—Ä PyTorch backend (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã –¥–≤–∞ CUDA-–±—ç–∫–µ–Ω–¥–∞:

| Extra | CUDA | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| `cu124` | 12.4 + cuDNN | –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
| `cu128` | 12.8 + cuDNN | –ù–æ–≤–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è |

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º backend

```bash
uv sync --extra cu124   # CUDA 12.4
uv sync --extra cu128   # CUDA 12.8
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –æ–±—ã—á–Ω—ã–π `uv sync` –±–µ–∑ `--extra` –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –æ—à–∏–±–∫–æ–π. PyTorch –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ `https://download.pytorch.org/whl`.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è lock-—Ñ–∞–π–ª–∞
uv sync --check

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏ PyTorch
uv run python -c "import torch; print(f'PyTorch: {torch.__version__}, CUDA: {torch.version.cuda}')"
```

## 3. –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export UV_TORCH_BACKEND=cu128
uv sync --locked
```

–£–¥–æ–±–Ω–æ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, –Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —è–≤–Ω—ã–π `--extra`.

## 4. –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏

### Dev-—Ä–µ–∂–∏–º
```bash
uv sync --extra cu124
```

### Staging/Prod-—Ä–µ–∂–∏–º—ã
```bash
uv sync --project staging --extra cu124 --frozen
uv sync --project prod --extra cu124 --frozen
```

### Docker-—Å–±–æ—Ä–∫–∞
```bash
docker build -f docker/Dockerfile-uv \
  --target dev \
  --build-arg TORCH_BACKEND=cu128 \
  -t project:dev-cu128 .
```

## 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è lock-—Ñ–∞–π–ª–æ–≤ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ backend

–î–ª—è —Ä–∞–∑–Ω—ã—Ö CUDA-–≤–µ—Ä—Å–∏–π –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ lock-—Ñ–∞–π–ª—ã:

```bash
# –û—Ç–¥–µ–ª—å–Ω—ã–µ lock-—Ñ–∞–π–ª—ã –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ CI
uv lock --extra cu124 -o uv-cu124.lock
uv lock --extra cu128 -o uv-cu128.lock

# –î–ª—è prod-—Ä–µ–∂–∏–º–∞
uv lock --project prod --extra cu124 -o prod/uv-cu124.lock
```

## 6. –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–≤–∏—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. **–ö–ª–æ–Ω–∏—Ä—É–µ–º —Å submodules**:
   ```bash
   git clone --recursive https://github.com/org/project.git
   ```

2. **–§–∏–∫—Å–∏—Ä—É–µ–º Python**:
   ```bash
   uv python pin 3.12
   ```

3. **–í—ã–±–∏—Ä–∞–µ–º CUDA –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º**:
   ```bash
   uv sync --extra cu124
   ```

4. **–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É**:
   ```bash
   uv run python -c "import torch; print('OK')"
   ```

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

- **[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏](04_dependency_management.md)** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤
- **[–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤](05_running_scripts.md)** ‚Äî `uv run` vs –∞–∫—Ç–∏–≤–∞—Ü–∏—è venv

---

> üí° **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
> - `uv sync` –±–µ–∑ `--extra` ‚Üí –æ—à–∏–±–∫–∞ PyTorch
> - –ó–∞–±—ã–ª–∏ `uv python pin` ‚Üí —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Python –≤ –∫–æ–º–∞–Ω–¥–µ
> - –ù–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã submodules ‚Üí –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–∞–∫–µ—Ç—ã