# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

–ó–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ —Å–ø–æ—Å–æ–±—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ `uv workspace` —Å –ø–æ–º–æ—â—å—é **`uv`**.

–í—Å–µ –æ–ø–∏—Å–∞–Ω–Ω–æ–µ –Ω–∏–∂–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **—Ç–æ–ª—å–∫–æ** –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
uv python pin 3.12         # —Ñ–∏–∫—Å–∞—Ü–∏—è Python
uv sync --extra cu124       # –≤—ã–±–æ—Ä CUDA –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```

> üìñ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**: [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](03_environment_setup.md) ‚Äî Python –≤–µ—Ä—Å–∏–∏ –∏ CUDA backends

## 1. –ö–æ–º–∞–Ω–¥–∞ `uv add` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±)

–£–¥–æ–±–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

### 1.1 –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–Ω–∞—à –ø—Ä–æ–µ–∫—Ç)

```bash
uv add numpy>=1.26
```

–ö–æ–º–∞–Ω–¥–∞:
- –¥–æ–±–∞–≤–∏—Ç —Å—Ç—Ä–æ–∫—É `numpy>=1.26` –≤ —Å–µ–∫—Ü–∏—é `[project].dependencies` –∫–æ—Ä–Ω–µ–≤–æ–≥–æ `pyproject.toml` –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞;
- –æ–±–Ω–æ–≤–∏—Ç `uv.lock`, –ø–æ–¥–æ–±—Ä–∞–≤ —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –≤–µ—Ä—Å–∏—é;
- —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–∞–∫–µ—Ç –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

### 1.2 Dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

```bash
uv add ruff --group dev
```

–ö–æ–º–∞–Ω–¥–∞:
- –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –≥—Ä—É–ø–ø—É **dev** –≤–Ω—É—Ç—Ä–∏ `[dependency-groups]` –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞;
- —Ç–∞–∫–∏–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –ø—Ä–∏ –æ–±—ã—á–Ω—ã—Ö `uv sync` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é dev-–≥—Ä—É–ø–ø–∞ –∞–∫—Ç–∏–≤–Ω–∞) –∏ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π prod-—Å–±–æ—Ä–∫–∏ –ø—Ä–∏ `uv sync --no-default-groups`.

### 1.3 –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞

```bash
# –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–∞–∫–µ—Ç–∞
cd packages/bench_utils
uv add numpy>=1.26

# –∏–ª–∏ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
uv add numpy>=1.26 --package bench-utils
```

–ö–æ–º–∞–Ω–¥–∞:
- –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å **—Ç–æ–ª—å–∫–æ** –≤ python-–ø–∞–∫–µ—Ç `packages/bench_utils/pyproject.toml`;
- workspace –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π;
- lock-—Ñ–∞–π–ª –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –±—É–¥—É—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### 1.4 –û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏

- `--optional extra_name` ‚Äî –ø–æ–º–µ—â–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ `[project.optional-dependencies]`, –¥–æ—Å—Ç—É–ø–Ω—É—é —á–µ—Ä–µ–∑ `--extra`;
  –ø—Ä–∏–º–µ—Ä: `uv add flash-attn --optional flash`.
- `--index`, `--path`, `--git` ‚Äî –ø–æ–∑–≤–æ–ª—è—é—Ç —É–∫–∞–∑–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ (PyPI-–∑–µ—Ä–∫–∞–ª–æ, –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å, Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π).
  –ø—Ä–∏–º–µ—Ä: `uv add mylib --git "https://github.com/user/mylib.git"`.
- `--bounds major|minor|exact` ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –≤–µ—Ä—Å–∏–π (semver).
  –ø—Ä–∏–º–µ—Ä: `uv add pandas --bounds minor` –¥–æ–±–∞–≤–∏—Ç `pandas>=2,<3`.

### 1.5 –ü—Ä–∏–º–µ—Ä –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

```bash
uv add torch>=2.3 transformers>=4.41 qwen-vl-utils>=0.0.10 \
       --package model-qwen2_5-vl
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞ —Ä–∞–∑:
1. –¥–æ–±–∞–≤–∏—Ç —Ç—Ä–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `packages/model_qwen2.5-vl/pyproject.toml`;
2. –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ—Ç `uv.lock`, —É—á–∏—Ç—ã–≤–∞—è –Ω–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã;
3. —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏—Ö –≤ `.venv`, –ø–æ–¥–≥–æ—Ç–æ–≤–∏–≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∫ –∑–∞–ø—É—Å–∫—É –º–æ–¥–µ–ª–∏.

### 1.6 FlashAttention –∫–∞–∫ optional-extra

```bash
uv add flash-attn --package model-qwen2_5-vl --optional flash
```

–ß—Ç–æ –¥–∞—ë—Ç:
- –ø–∞–∫–µ—Ç `flash-attn` –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω **—Ç–æ–ª—å–∫–æ**, –µ—Å–ª–∏ –ø—Ä–∏ `uv sync` (–∏–ª–∏ `uv run`) —É–∫–∞–∑–∞—Ç—å `--extra flash`;
- –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–±–æ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –±–µ–∑ —Ç—è–∂—ë–ª–æ–≥–æ CUDA-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –ø–æ–∫–∞ –æ–Ω–æ —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ.

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
uv sync --extra flash           # –Ω–∞–≤—Å–µ–≥–¥–∞ (–¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ sync)
uv run --extra flash python ‚Ä¶   # —Ä–∞–∑–æ–≤–æ
```

## 2. –†—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±)

### 2.1 –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–∞–∫–µ—Ç

1. –û—Ç–∫—Ä—ã—Ç—å `packages/<pkg>/pyproject.toml`.
1. –í —Å–µ–∫—Ü–∏–∏ `[project].dependencies` –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä:
   ```toml
   numpy>=1.26
   ```
1. –ò–∑ –∫–æ—Ä–Ω—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
   ```bash
   uv lock
   uv sync
   ```

### 2.2 –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ —Å–∞–º –ø—Ä–æ–µ–∫—Ç (–∫–æ—Ä–µ–Ω—å)

–ï—Å–ª–∏ –ø–∞–∫–µ—Ç –Ω—É–∂–µ–Ω –∏ —Å–∫—Ä–∏–ø—Ç–∞–º –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è, —Ä–∞—Å—à–∏—Ä—è–µ–º –∫–æ—Ä–Ω–µ–≤–æ–π `pyproject.toml`:

```toml
[project]
dependencies = [
    ...,
    "numpy>=1.26",
]
```

–î–∞–ª–µ–µ –≤—Å—ë —Ç–∞–∫ –∂–µ: `uv lock && uv sync`.

## 3. –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫-–ª–∏—Å—Ç

1. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `uv add` —Å –Ω—É–∂–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏.
2. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ**: –∏–∑–º–µ–Ω–∏—Ç—å `pyproject.toml` –≤—Ä—É—á–Ω—É—é.
3. `uv lock` ‚Üí –ø–µ—Ä–µ—Å—á—ë—Ç `uv.lock` (–µ—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤—Ä—É—á–Ω—É—é).
4. `uv sync` ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–µ—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤—Ä—É—á–Ω—É—é).
5. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- **[–ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤](05_running_scripts.md)** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `uv run` –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã
- **[–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤](06_adding_packages.md)** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö workspace-–ø–∞–∫–µ—Ç–æ–≤

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω
- **[Docker –∏ –¥–µ–ø–ª–æ–π](07_docker_deployment.md)** ‚Äî —Å–±–æ—Ä–∫–∞ prod-–æ–±—Ä–∞–∑–æ–≤ –∏ –¥–µ–ø–ª–æ–π
